<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>RAD GARLINGTON ‚Äî $RAD</title>

  <link rel="icon" href="/assets/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="apple-touch-icon" href="/assets/apple-touch-icon.png">
  <link rel="manifest" href="/assets/site.webmanifest">
  <meta name="theme-color" content="#0A74D0">
  <meta name="application-name" content="$RAD">
  <meta name="apple-mobile-web-app-title" content="$RAD">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="msapplication-TileColor" content="#0A74D0">

  <meta name="description" content="$RAD ‚Äì The meme coin with a ledger. Rad Garlington is the Protocol‚Äôs most loyal believer. Built on XRPL with 1 trillion supply.">
  <meta name="keywords" content="Rad Garlington,RAD,meme coin,XRPL,XRP Ledger,crypto,ledger meme,digital asset,XRP meme coin">

  <meta property="og:title" content="RAD GARLINGTON ‚Äî $RAD">
  <meta property="og:description" content="$RAD ‚Äì The meme coin with a ledger. Built on XRPL.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://radgarlington.io/">
  <meta property="og:site_name" content="RAD GARLINGTON">
  <meta property="og:image" content="https://github.com/radgarlington/radgarlington.io/blob/main/assets/rad_garlington.png?raw=true">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="RAD GARLINGTON ‚Äî $RAD">
  <meta name="twitter:description" content="$RAD ‚Äì The meme coin with a ledger. Built on XRPL.">
  <meta name="twitter:image" content="https://github.com/radgarlington/radgarlington.io/blob/main/assets/rad_garlington.png?raw=true">

  <style>
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    :root{ --bg:#ffffff; --ink:#0f172a; --muted:#475569; --blue:#0A74D0; --card:#f4f7fb; --ring:rgba(10,116,208,.22); }
    html { -webkit-text-size-adjust: 100%; }
    body { margin:0; background:var(--bg); color:var(--ink); font-family: Arial, sans-serif; line-height:1.5; overflow-x:hidden; min-height:100vh; display:flex; flex-direction:column; }
    main { flex: 1 0 auto; }
    p { margin:0 0 10px; }

    .hero { text-align:center; padding:6vh 5vw 2vh; background:#eaf3ff; border:2px solid #d7e7ff; border-radius:12px; max-width:960px; margin:20px auto; box-shadow:0 6px 20px rgba(2,32,71,.08); }
    .hero-img { width:55%; max-width:320px; height:auto; margin:0 auto 14px; display:block; }
    h1 { font-size: clamp(1.8rem, 6vw, 2.8rem); margin-bottom:10px; }
    .tagline { font-size: clamp(1rem, 4vw, 1.3rem); color: var(--muted); margin-bottom:4px; padding:0 10px; }

    .social { text-align:center; margin-top:14px; }
    .social a{ display:inline-block; margin:0 8px; text-decoration:none; line-height:0; vertical-align:middle; }
    .social img{ width:28px; height:28px; display:inline-block; }

    .verify { margin-top:8px; font-size:0.95rem; text-align:center; }
    .verify a{ color:var(--blue); font-weight:bold; text-decoration:none; display:inline-block; margin:0 8px; }

    .utility { text-align:center; padding:4vh 5vw 6vh; background:#f0f7ff; border:2px solid #d0e3ff; border-radius:12px; max-width:960px; margin:20px auto; box-shadow:0 6px 20px rgba(2,32,71,.08); }
    .utility h2 { font-size: clamp(1.5rem, 5vw, 2rem); margin-bottom:15px; }
    .utility p { font-size: clamp(1rem, 4vw, 1.2rem); color: var(--muted); margin:6px 0; }

    .otc-section { background: var(--card); color: var(--ink); padding: 6vh 5vw; overflow-x:hidden; }
    .otc-wrap { max-width: 900px; margin: 0 auto; text-align: center; padding: 0 12px; }
    .otc-head { display:flex; align-items:center; justify-content:center; gap:10px; flex-wrap:wrap; }
    .otc-section h2 { font-size: clamp(1.5rem, 5vw, 2rem); margin: 0; }

    .price-line{
      display:flex; flex-wrap:wrap; justify-content:center; align-items:center;
      gap:.5rem; padding:10px 14px; border-radius:14px; background:#fff; color:var(--blue);
      border:2px solid var(--blue); font-weight:800; font-size: clamp(0.95rem, 3.6vw, 1.1rem);
      letter-spacing:.2px; box-shadow:0 0 0 2px #fff inset, 0 10px 22px rgba(2,32,71,.10);
      margin:6px auto 18px; max-width:100%; white-space:normal; word-break:keep-all;
    }
    .price-line .sep{ opacity:.6 }
    .price-line .spot-rate{ flex-basis:100%; text-align:center; }

    .status-badge { display:inline-flex; align-items:center; gap:.5rem; font:600 12px/1.1 system-ui, -apple-system, Segoe UI, Roboto, Arial;
      padding:.35rem .6rem; border-radius:999px; border:1px solid var(--ring); background:#fff; color:#0b3d78; user-select:none; }
    .status-dot{ width:.5rem; height:.5rem; border-radius:50%; background:#6aa1ea; }
    .status-badge.live  { background:#e8f2ff; }
    .status-badge.down  { background:#f0f6ff; }

    .btn{ display:inline-flex; align-items:center; justify-content:center; gap:.5rem; padding:12px 18px; border-radius:10px; text-decoration:none;
      font:600 16px/1.1 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; box-shadow:0 6px 20px rgba(2,32,71,.12);
      transform:translateY(0); transition:transform .12s ease, box-shadow .12s ease, opacity .12s ease; cursor:pointer; user-select:none; border:none; }
    .btn:hover{ transform:translateY(-1px); box-shadow:0 10px 26px rgba(2,32,71,.16); }
    .btn:active{ transform:translateY(0); box-shadow:0 4px 14px rgba(2,32,71,.10); }
    .btn[aria-disabled]{ opacity:.55; cursor:not-allowed; transform:none; box-shadow:0 4px 14px rgba(2,32,71,.08); pointer-events:none; }
    .btn-primary{ background:var(--blue); color:#fff; }
    .btn-trustline{ display:inline-block; padding:12px 18px; border-radius:10px; background:var(--blue); color:#fff; text-decoration:none;
      font:600 16px/1.1 system-ui, -apple-system, Segoe UI, Roboto, Arial; box-shadow:0 6px 20px rgba(2,32,71,.14); margin-top:4px; }

    input, select, textarea { font-size:16px; }
    #usdInput { width:100%; max-width:320px; -webkit-appearance:none; }

    .card { width:100%; max-width:520px; margin:0 auto; background:#fff; border:3px solid var(--blue); border-radius:12px; box-shadow:0 6px 20px rgba(2,32,71,0.08); padding:20px; text-align:center; color:var(--ink); }

    .footer { text-align:center; padding:18px 10px; font-size:0.85rem; color:var(--muted); margin-top:auto; }
  </style>
</head>
<body>

  <main>
    <!-- ... header / hero / trustline / disclaimers unchanged ... -->

    <div class="otc-section">
      <div class="otc-wrap">
        <div class="otc-head">
          <h2>$RAD ‚Äî OTC PRE-SALE</h2>
          <div id="liveStatus" class="status-badge down" title="OTC connectivity">
            <span class="status-dot"></span>
            <span id="liveText">OFFLINE</span>
          </div>
        </div>

        <div class="price-line" id="spotLine">
          <span>1M $RAD = $1 USD</span>
          <span class="sep">¬∑</span>
          <span>Powered by XRP</span>
          <span class="sep">¬∑</span>
          <span class="spot-rate">Live: $‚Äî/XRP</span>
        </div>

        <div class="card">
          <a class="btn-trustline" href="https://xrpl.services/?issuer=rKpaNoTRdXa48W7emkKgtCLz2MuhEroU7V&currency=RAD&limit=1000000000000" target="_blank" rel="noopener">
            Set $RAD Trustline
          </a>

          <label for="usdInput" style="font-weight:bold; display:block; margin-bottom:10px; margin-top:14px;">Enter amount in USD</label>
          <input id="usdInput" type="number" inputmode="decimal" min="1" step="0.01" placeholder="1.00 USD"
                 autocomplete="off" style="padding:10px; font-size:16px; width:100%; max-width:320px; border:2px solid #cbd5e1; border-radius:8px;" />

          <div id="xrpConversion" style="margin-top:20px; font-size:1rem;">üîÅ XRP Required: 0</div>
          <div id="radAmount" style="margin-top:10px; font-size:1.1rem; font-weight:bold;">ü™ô You‚Äôll receive: 0 $RAD</div>

          <div style="margin-top:14px;">
            <a id="btnBuy" class="btn btn-primary" href="#" aria-disabled title="Enter an amount to enable">üõí BUY</a>
          </div>

          <div style="margin-top:30px; font-size:0.95rem; color:var(--ink); background:#f7faff; border:2px solid #d7e7ff; padding:16px; border-radius:10px;">
            <p style="margin:0 0 8px;">üéØ <strong>OTC Rate:</strong> $0.000001 per $RAD</p>
            <p style="margin:0 0 8px;">üöÄ <strong>Public Launch Price:</strong> $0.000003 per $RAD</p>
            <p style="margin:0;">‚úÖ OTC buyers in early ‚Äî 3√ó value at launch</p>
          </div>
        </div>
      </div>
    </div>
  </main>

  <div class="footer">
    ¬© 2025 RAD GARLINGTON | radgarlington.io | Powered by XRP
  </div>

<script>
  const API = "https://api.radgarlington.io";
  const MIN_USD = 1;

  const usdInput      = document.getElementById('usdInput');
  const xrpConversion = document.getElementById('xrpConversion');
  const radAmount     = document.getElementById('radAmount');
  const btnBuy        = document.getElementById('btnBuy');
  const spotLine      = document.getElementById('spotLine');
  const liveBadge     = document.getElementById('liveStatus');
  const liveText      = document.getElementById('liveText');

  function setBadge(state, text){
    liveBadge.classList.remove("live","down");
    liveBadge.classList.add(state);
    liveText.textContent = text;
  }

  function disableBuy(msg){
    btnBuy.setAttribute("aria-disabled","");
    btnBuy.href = "#";
    btnBuy.onclick = (e)=>e.preventDefault();
    btnBuy.title = msg || "Enter an amount to enable";
  }

  function openXaman(uuid){
    const appUrl = `xumm://sign/${uuid}`;
    const goUrl  = `${API}/go/${uuid}`;
    // try open Xaman app
    window.location.href = appUrl;
    // fallback
    setTimeout(()=>{ window.location.href = goUrl; }, 800);
  }

  function enableBuyForUSD(usd){
    btnBuy.removeAttribute("aria-disabled");
    btnBuy.title = "Open in Xaman";
    btnBuy.onclick = async (e)=>{
      e.preventDefault();
      try {
        const r = await fetch(`${API}/api/deeplink?usd=${encodeURIComponent(usd.toFixed(2))}&_=${Date.now()}`, {redirect:"manual"});
        const loc = r.headers.get("Location");
        if(!loc){ alert("Failed to get deeplink"); return; }
        const uuid = loc.split("/go/").pop();
        openXaman(uuid);
      } catch(err){
        console.error(err);
        alert("Error creating payment link");
      }
    };
  }

  async function refreshStatus(){
    try{
      const r = await fetch(`${API}/api/status?_=${Date.now()}`, { cache:'no-store' });
      const j = await r.json();
      if (j && j.ok && j.running) { setBadge("live","LIVE"); return; }
    }catch{}
    setBadge("down","OFFLINE");
  }
  refreshStatus(); setInterval(refreshStatus, 10000);

  const priceState = { usdPerXrp: NaN, locked: false };
  async function fetchUsdPerXrp(){
    const r = await fetch(`${API}/api/price?_=${Date.now()}`, { cache:'no-store' });
    const j = await r.json();
    if (!j.ok) throw new Error('price not ok');
    const v = Number(j.xrp_usd);
    if (!Number.isFinite(v) || v <= 0) throw new Error('bad price');
    return v;
  }
  async function getLockedPrice(){
    if (priceState.locked && Number.isFinite(priceState.usdPerXrp)) return priceState.usdPerXrp;
    const v = await fetchUsdPerXrp();
    priceState.usdPerXrp = v;
    priceState.locked = true;
    return v;
  }

  const fmt = (n,d=6)=>Number(n).toFixed(d);
  function parseUSD(raw){
    if (raw == null) return NaN;
    const cleaned = String(raw).trim().replace(',', '.').replace(/[^\d.]/g,'');
    const parts = cleaned.split('.');
    const norm = parts.length > 2 ? parts[0] + '.' + parts.slice(1).join('') : cleaned;
    const n = Number(norm);
    return Number.isFinite(n) ? n : NaN;
  }

  async function handleUSDInput(){
    const usd = parseUSD(usdInput.value);
    xrpConversion.textContent = 'üîÅ XRP Required: 0';
    radAmount.textContent = 'ü™ô You‚Äôll receive: 0 $RAD';
    disableBuy("Enter an amount to enable");

    if (!Number.isFinite(usd) || usd < MIN_USD){
      if (usd>0) xrpConversion.textContent='‚ùå Minimum $1';
      return;
    }
    try{
      const usdPerXrp = await getLockedPrice();
      const xrpNeeded = usd / usdPerXrp;
      xrpConversion.textContent = `üîÅ XRP Required: ${fmt(xrpNeeded)} XRP (Rate: $${usdPerXrp.toFixed(4)}/XRP)`;
      radAmount.textContent     = `ü™ô You‚Äôll receive: ${(usd * 1_000_000).toLocaleString()} $RAD`;
      enableBuyForUSD(usd);
    }catch(e){
      console.error(e);
      xrpConversion.textContent = '‚ö†Ô∏è Could not fetch price';
      radAmount.textContent = 'ü™ô You‚Äôll receive: 0 $RAD';
      disableBuy("Could not fetch price");
    }
  }
  usdInput.addEventListener('input', handleUSDInput);
</script>

</body>
</html>
