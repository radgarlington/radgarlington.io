<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>The RAD Ledger</title>
<link rel="stylesheet" href="/static/style.css">
<script src="https://xumm.app/assets/cdn/xumm.min.js"></script>
</head>
<body>
<header>
  <h1>The RAD Ledger</h1>
  <p>Certified Builders. On-Ledger Truth.</p>
</header>

<main>
  <div id="ledger"></div>

  <div class="paybox">
    <input id="project" placeholder="Project Name">
    <input id="issuer" placeholder="Issuer Address">
    <button onclick="payCert()">Pay 5 XRP — Get Certified</button>
  </div>
</main>

<script>
async function payCert(){
  const project = document.getElementById('project').value;
  const issuer = document.getElementById('issuer').value;

  const res = await fetch('/create_payload', {
    method:'POST', headers:{'Content-Type':'application/json'},
    body: JSON.stringify({project, issuer, amount:5})
  });
  const data = await res.json();
  if (data.next && data.next.always) window.open(data.next.always, '_blank');
}

async function loadLedger(){
  const r = await fetch('/ledger.json');
  const d = await r.json();
  const el = document.getElementById('ledger');
  el.innerHTML = d.length ? d.map(p=>`
    <div class="entry">
      <strong>${p.project}</strong> — ${p.status}<br>
      Issuer: ${p.issuer}<br>
      Ledger: ${p.ledger_index}
    </div>
  `).join('') : '<p>No certified entries yet.</p>';
}
loadLedger();
</script>
</body>
</html>
