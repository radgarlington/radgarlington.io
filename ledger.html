<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>The RAD Ledger ‚Äî Source of Truth</title>
<style>
*{box-sizing:border-box}
body{margin:0;background:#fff;color:#0f172a;font-family:Arial,system-ui,sans-serif}
/* Banner */
.banner{background:linear-gradient(90deg,#0A74D0,#083c80);color:#fff;text-align:center;
  padding:20px 10px 18px;font-size:1.05rem;font-weight:600;line-height:1.4;
  border-bottom:2px solid #062a5c;box-shadow:0 4px 10px rgba(0,0,0,.25)}
.banner em{display:block;margin-top:6px;font-style:italic;font-weight:500;opacity:.85}
/* Header */
header{text-align:center;padding:52px 10px 20px;background:#eaf3ff;border-bottom:2px solid #d7e7ff;position:relative}
header h1{font-size:2.2rem;margin:0;color:#0A74D0}
header p{margin:10px 0 0;color:#334155}
/* Back button */
.back-btn{position:absolute;top:10px;left:18px;background:#0A74D0;color:#fff;
  padding:6px 10px;border-radius:6px;text-decoration:none;font-weight:600;font-size:.8rem;letter-spacing:.2px;
  transition:opacity .2s ease,transform .2s ease}
.back-btn:hover{opacity:.9;transform:translateY(-1px)}
/* Annual notice */
.annual{
  max-width:760px;
  margin:20px auto 24px;
  padding:14px 16px;
  border-radius:10px;
  border:1px solid #d4e1ff;
  background:#edf3ff;
  color:#0f172a;
  font-size:.95rem;
  line-height:1.5;
}
.annual ul{margin:6px 0 6px 18px;padding:0;list-style:disc}
/* Legend */
.legend{background:#f1f5fb;color:#0A74D0;text-align:center;font-size:.95rem;font-weight:600;
  padding:12px 8px;border-bottom:1px solid #d7e7ff;line-height:1.6}
.legend span{display:block;margin:4px 0}
/* View filters */
.view-filters{
  background:#eef2ff;
  border-bottom:2px solid #d7e7ff;
  padding:10px 12px;
  display:flex;
  justify-content:center;
  align-items:center;
  gap:8px;
  flex-wrap:wrap;
}
.view-label{
  font-size:.9rem;
  font-weight:600;
  color:#0A74D0;
}
.view-pill{
  border:none;
  border-radius:999px;
  padding:4px 10px;
  font-size:.85rem;
  cursor:pointer;
  background:#e5e7eb;
  color:#111827;
  font-weight:600;
  transition:background .15s ease,transform .15s ease;
}
.view-pill:hover{
  background:#d4d4d8;
  transform:translateY(-1px);
}
.view-pill.active{
  background:#0A74D0;
  color:#f9fafb;
}
/* Rug / Blacklist / Shill Links */
.rug-link-container{text-align:center;background:#fffbe6;border-bottom:2px solid #d7e7ff;padding:14px 0 22px}
.rug-link{display:inline-block;background:#facc15;color:#111827;font-weight:700;font-size:.95rem;text-decoration:none;
  padding:9px 18px;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,.25);border:2px solid #b45309;transition:all .2s ease}
.rug-link:hover{background:#fde047;transform:translateY(-2px) scale(1.02);box-shadow:0 3px 8px rgba(0,0,0,.3)}
/* Submit Link */
.submit-link{display:inline-block;background:#0A74D0;color:#fff;font-weight:600;font-size:.9rem;text-decoration:none;
  padding:8px 14px;border-radius:8px;margin:12px auto 24px;box-shadow:0 2px 5px rgba(0,0,0,.2);transition:background .2s ease,transform .2s ease}
.submit-link:hover{background:#094d9d;transform:translateY(-2px)}
.submit-link-container{text-align:center;background:#f9fbff;border-bottom:2px solid #d7e7ff;padding-bottom:20px}
main{max-width:900px;margin:30px auto;padding:0 16px}
h2{color:#0A74D0;border-bottom:1px solid #cbd5e1;padding-bottom:4px;font-size:1.3rem;margin-bottom:14px}
h3{color:#0A74D0;font-size:1.1rem;margin:10px 0}
ul{list-style:none;padding:0;margin:0}
li.entry{margin:6px 0;padding:8px 10px;border-bottom:1px dashed #cbd5e1;font-size:.95rem;
  display:flex;justify-content:space-between;align-items:center;cursor:pointer;border-radius:6px;transition:background .15s ease}
li.entry:hover{background:#f1f7ff}
li span{color:#475569;font-size:.85rem}
footer{text-align:center;padding:20px;border-top:2px solid #d7e7ff;color:#475569;font-size:.9rem}
/* Modal */
.modal{display:none;position:fixed;z-index:999;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,.55)}
.modal-content{background:#fff;color:#0f172a;margin:8% auto;padding:20px;border:2px solid #d0e3ff;border-radius:10px;width:90%;max-width:500px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
.close{float:right;font-size:1.5rem;cursor:pointer;color:#0A74D0}
.close:hover{color:#083c80}
.modal-content a{color:#0A74D0;text-decoration:none;font-weight:bold}
.checkmark{color:#0A74D0;font-weight:bold}
</style>
</head>

<body>
<div class="banner">
  üöß The Ledger‚Äôs being built. Verified projects will appear soon.<br>Don‚Äôt rush perfection.
  <em>‚Äî Rad</em>
</div>

<header>
  <a href="/" class="back-btn">‚Üê Back</a>
  <h1>The RAD Ledger</h1>
  <p>The meme coin with a ledger ‚Äî certifying XRPL projects.</p>
</header>

<section class="annual">
  <strong>Listings, Certification & Renewals</strong>
  <p style="margin:8px 0 4px">
    The RAD Ledger separates <strong>Certified</strong> projects from <strong>Verified</strong> projects.
  </p>
  <ul>
    <li><strong>Certified</strong> listings are permanent unless downgraded for cause.</li>
    <li><strong>Verified</strong> listings are annual and must renew every 12 months.</li>
    <li>Renewals go through the same process as initial verification.</li>
  </ul>
  <p style="margin:6px 0 0">Expired listings must pass review again.</p>
</section>

<div class="legend">
  <span>üü° Certified ‚Äî Doxxed + Seal NFT</span>
  <span>üî∑ Verified ‚Äî Non-Doxxed</span>
  <span>‚ö´ Unverified ‚Äî Auto-Listed from XRPL</span>
  <span>‚¨õ Expired ‚Äî Renewal Required</span>
</div>

<div class="view-filters">
  <span class="view-label">View:</span>
  <button class="view-pill active" data-filter="all">All</button>
  <button class="view-pill" data-filter="certified">Certified</button>
  <button class="view-pill" data-filter="verified">Verified</button>
  <button class="view-pill" data-filter="unverified">Unverified</button>
  <button class="view-pill" data-filter="expired">Expired</button>
</div>

<div class="rug-link-container">
  <a href="/rugreport.html" class="rug-link">‚ö†Ô∏è The Rug Report ‚Äî View Flagged Projects ‚ö†Ô∏è</a>
</div>

<div class="rug-link-container" style="background:#ffe8e8;border-bottom:2px solid #d7e7ff;padding:16px 0 22px;">
  <a href="/blacklist.html" class="rug-link"
     style="background:#dc2626;color:#fff;border-color:#7f1d1d;">
    üõë THE BLACKLIST ‚Äî View Scammers üõë
  </a>
</div>

<div class="rug-link-container" style="background:#fff3e0;border-bottom:2px solid #d7e7ff;padding:16px 0 22px;">
  <a href="/shills.html" class="rug-link"
     style="background:#fb923c;color:#111827;border-color:#c2410c;">
    ü§° THE SHILL LIST ‚Äî View The Clowns ü§°
  </a>
</div>

<div class="submit-link-container">
  <a href="#submit-section" class="submit-link">üßæ Submit Your Token</a>
</div>

<main>
  <section id="ledger">
    <h2>üìú All Projects on The Ledger</h2>
    <div id="ledgerList"></div>
  </section>

  <section id="submit-section" class="submit-banner"
    style="background:#f0f7ff;border:2px solid #d0e3ff;border-radius:12px;padding:28px;text-align:center;margin:40px 0">
    <h2>üßæ Submit Your Token</h2>
    <p>Get your XRPL project officially verified by The RAD Ledger.</p>
    <a href="/submit.html" class="back-btn"
       style="position:relative;top:auto;left:auto;background:#0A74D0;padding:10px 16px;border-radius:8px;font-size:.9rem;">
       Submit for Verification
    </a>
  </section>
</main>

<footer>¬© 2025 The RAD Ledger | Verified by Rad Garlington</footer>

<div id="tokenModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <div id="modalLogoWrap" style="text-align:center;margin-bottom:8px;display:none;">
      <img id="modalLogo" src="" alt="Project Logo"
           style="max-width:80px;max-height:80px;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,.25);object-fit:contain;">
    </div>
    <h2 id="modalToken">$RAD</h2>
    <p><strong>Certificate:</strong> <span id="modalCert"></span></p>
    <p><strong>Tier:</strong> <span id="modalTier"></span></p>
    <p><strong>Developer:</strong> <span id="modalDev"></span></p>
    <p><strong>Developer ùïè:</strong> <a id="modalDevX" href="#" target="_blank"></a></p>
    <p><strong>Doxxed:</strong> <span id="modalDoxxed"></span></p>
    <p><strong>Issuer:</strong> <span id="modalIssuer"></span></p>
    <p><strong>Website:</strong> <a id="modalWebsite" href="#" target="_blank"></a></p>
    <p><strong>Email:</strong> <span id="modalEmail"></span></p>
    <p><strong>Social:</strong> <a id="modalX" href="#" target="_blank">ùïè</a> | <a id="modalTG" href="#" target="_blank">Telegram</a></p>
    <p><strong>Seal NFT:</strong> <span id="modalNFT"></span></p>
  </div>
</div>

<script>
let allProjects = [];
let currentFilter = "all";
let modal = null;

function isExpired(entry){
  if(!entry.expires_at) return false;
  const today = new Date().toISOString().slice(0,10);
  return entry.expires_at < today;
}

function getCategory(entry){
  const tier = (entry.tier || "").toLowerCase();
  if(tier === "certified") return "certified";
  if(tier === "verified") return isExpired(entry) ? "expired" : "verified";
  return "unverified";
}

function getMeta(entry){
  if(entry.tier === "Certified"){
    return `Certified ¬∑ Unlimited`;
  }
  if(entry.tier === "Verified"){
    return isExpired(entry) ? "Expired" : "Verified";
  }
  if(entry.tier === "Unverified"){
    return `Issuers: ${(entry.issuers || []).length}`;
  }
  return "";
}

function getIcon(category){
  if(category === "certified") return "üü°";
  if(category === "verified") return "üî∑";
  if(category === "expired") return "‚¨õ";
  return "‚ö´";
}

function renderLedger(){
  const ledger = document.getElementById("ledgerList");
  ledger.innerHTML = "";

  const grouped = {};

  allProjects.forEach(p => {
    if(currentFilter !== "all" && p.category !== currentFilter) return;

    const clean = (p.token || "").replace(/^\$/,"");
    const letter = (clean.charAt(0) || "#").toUpperCase();

    if(!grouped[letter]) grouped[letter] = [];
    grouped[letter].push(p);
  });

  const letters = Object.keys(grouped).sort();
  if(!letters.length){
    ledger.innerHTML = '<p>No projects found.</p>';
    return;
  }

  letters.forEach(letter => {
    const wrap = document.createElement("div");
    wrap.innerHTML = `<h3>${letter}</h3>`;
    const ul = document.createElement("ul");

    grouped[letter].forEach(entry => {
      const li = document.createElement("li");
      li.className = "entry";

      const icon = getIcon(entry.category);
      const meta = getMeta(entry);

      const payload = JSON.stringify(entry).replace(/'/g,"&#39;");
      li.setAttribute("data-token", payload);

      li.innerHTML = `
        <span>${icon} ${entry.token}</span>
        <span>${meta}</span>
      `;

      ul.appendChild(li);
    });

    wrap.appendChild(ul);
    ledger.appendChild(wrap);
  });
}


function openModalForToken(entry){
  const modal = document.getElementById("tokenModal");
  modal.style.display = "block";

  const logoWrap = document.getElementById("modalLogoWrap");
  const logoImg = document.getElementById("modalLogo");

  if(entry.logo_url){
    logoImg.src = entry.logo_url;
    logoWrap.style.display = "block";
  } else {
    logoImg.src = "";
    logoWrap.style.display = "none";
  }

  document.getElementById("modalToken").textContent = entry.token;
  document.getElementById("modalCert").textContent  = entry.cert || "XRPL-AUTO";
  document.getElementById("modalTier").textContent  = entry.tier || "Unverified";

  document.getElementById("modalDev").textContent = entry.dev || "‚Äî";

  const devx = document.getElementById("modalDevX");
  devx.href = entry.devx || "#";
  devx.textContent = entry.devx ? entry.devx.replace("https://x.com/","@") : "";

  document.getElementById("modalDoxxed").innerHTML = entry.doxxed
    ? '<span class="checkmark">‚úÖ</span> Doxxed'
    : "‚ùå Undoxxed";

  document.getElementById("modalIssuer").textContent = entry.issuer || "‚Äî";

  const web = document.getElementById("modalWebsite");
  web.textContent = entry.website || "‚Äî";
  web.href = entry.website || "#";

  document.getElementById("modalEmail").textContent = entry.email || "‚Äî";
  document.getElementById("modalX").href = entry.x || "#";
  document.getElementById("modalTG").href = entry.tg || "#";

  if(entry.nft){
    document.getElementById("modalNFT").innerHTML =
      `<a href="${entry.nft}" target="_blank">View Seal NFT</a>`;
  } else {
    document.getElementById("modalNFT").textContent = "‚Äî";
  }

  // üî• Unverified Issuer List (NEW)
  const issuerBlock = document.createElement("div");
  issuerBlock.style.marginTop = "12px";

  if(entry.tier === "Unverified" && Array.isArray(entry.issuers)){
    issuerBlock.innerHTML = `
      <p><strong>Issuers (${entry.issuers.length}):</strong></p>
      ${entry.issuers.map(iss => `
        <div style="padding:8px;margin:6px 0;border:1px solid #d4e1ff;border-radius:8px;">
          <div><strong>Issuer:</strong> ${iss.issuer}</div>
          <div><strong>Domain:</strong> ${iss.domain || "‚Äî"}</div>
        </div>
      `).join("")}
    `;
  }

  document.querySelector(".modal-content").appendChild(issuerBlock);

  // Clear previous issuer blocks on close
  modal.dataset.cleanup = "true";
}


async function loadLedger(){
  try{
    const res = await fetch("ledger.json", { cache: "no-store" });
    const data = await res.json();

    allProjects = data.map(entry => ({
      ...entry,
      category: getCategory(entry)
    }));

    renderLedger();
  }catch(err){
    console.error(err);
    document.getElementById("ledgerList").innerHTML = "Error loading ledger.";
  }
}


document.addEventListener("DOMContentLoaded", () => {
  modal = document.getElementById("tokenModal");
  const close = document.querySelector(".close");

  close.onclick = () => {
    const modal = document.getElementById("tokenModal");
    modal.style.display = "none";

    // cleanup issuer blocks
    const extra = document.querySelectorAll(".modal-content > div");
    if(extra.length > 2){
      extra.forEach((e, i) => { if(i > 1) e.remove(); });
    }
  };

  window.onclick = e => {
    if(e.target === modal){
      close.onclick();
    }
  };

  // Click handler for ALL tokens, including unverified
  document.addEventListener("click", e => {
    const li = e.target.closest(".entry");
    if(!li || !li.dataset.token) return;

    let entry;
    try{
      entry = JSON.parse(li.dataset.token.replace(/&#39;/g,"'"));
    }catch(err){
      console.error(err);
      return;
    }

    openModalForToken(entry);
  });

  // View filters
  const filterPills = document.querySelectorAll(".view-filters .view-pill");
  filterPills.forEach(pill => {
    pill.addEventListener("click", () => {
      currentFilter = pill.dataset.filter;
      filterPills.forEach(p => p.classList.toggle("active", p === pill));
      renderLedger();
    });
  });

  loadLedger();
});
</script>



</body>
</html>
